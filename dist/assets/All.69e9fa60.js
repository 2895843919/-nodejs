import{_ as I,p as D,d as f,s as S,a as $,g as d,h as P,e as U}from"./index.33dde8d4.js";import{_ as T}from"./\u8033\u673A.87de1b1a.js";import{r as h,A as z,o as r,c,b as s,t as p,d as g,w as u,F as m,u as v,h as x,C as E,p as j,g as B}from"./vendor.632c8900.js";const N={name:"playlist_all",data(){return{comments:[],page:{currentPage:1,pagesize:20,tableData:[],pre:0},playlist_hight:[],query_cat:"",total:"",catlist:{categories:[],sub:[],category:[],category0:[],category1:[],category2:[],category3:[],category4:[]},category:[],visible:!1,loading:!0,playlist_msg:[],playlist_tracks:[]}},async created(){this.query_cat=this.$route.query.cat,this.$route.query.cat=="\u5168\u90E8"||this.$route.query.cat==""?await this.Top_playlist(this.query_cat):await this.Top_playlist(this.query_cat),await this.Playlist_catlist()},methods:{go_playlist(t){console.log(t),this.$router.push({path:"/discover/playlist_item",query:{id:t}})},click_audioPlay(t){D({id:t}).then(e=>{console.log(e),this.playlist_msg=e,this.playlist_tracks=e.playlist.tracks,this.$store.commit("saveSong_list",this.playlist_tracks),this.playlist_tracks.forEach(i=>{i.dt=f(i.dt)}),this.Song_detail(this.playlist_msg)}).catch(e=>{console.log(e)})},Song_detail(t){setTimeout(()=>{S({id:t.privileges[0].id}).then(e=>{this.$store.commit("saveSong_url",e.data[0].url),$({ids:t.privileges[0].id}).then(i=>{this.$store.commit("saveSong_img",i.songs[0].al.picUrl),this.$store.commit("saveSong_name",i.songs[0].name),this.$store.commit("saveSong_singer",i.songs[0].ar[0].name),this.$store.commit("saveSong_dt",f(i.songs[0].dt)),this.$store.commit("saveSong_time",i.songs[0].dt)})})},0)},filter_playCount(t){return t=t+"",t>1e4?t.substring(0,t.length-4)+"\u4E07":t},async handleCurrentChange(t){if(window.scrollTo(0,0),this.page.currentPage=t,this.page.pre=20*(t-1),this.playlist_hight=this.page.tableData.slice(this.page.pre,this.page.pre+20),this.page.currentPage>=this.page.tableData.length/20){let e=Math.ceil(this.page.currentPage/5);for(let i=0;i<e-1;i++)await d({cat:this.query_cat,offset:20*(this.page.currentPage-1)}).then(l=>{l.playlists.forEach(a=>{a.coverImgUrl=a.coverImgUrl+"?param=130y130"}),this.page.tableData=this.page.tableData.concat(l.playlists),this.playlist_hight=this.page.tableData.slice(this.page.pre,this.page.pre+20)}).catch(l=>{console.log(l)})}},async Playlist_catlist(){P().then(t=>{this.catlist.categories=t.categories,this.catlist.sub=t.sub,this.catlist.sub.forEach(e=>{e.category==0?(this.catlist.category0.push(e.name),this.category[0]=this.catlist.category0):e.category==1?(this.catlist.category1.push(e.name),this.category[1]=this.catlist.category1):e.category==2?(this.catlist.category2.push(e.name),this.category[2]=this.catlist.category2):e.category==3?(this.catlist.category3.push(e.name),this.category[3]=this.catlist.category3):e.category==4&&(this.catlist.category4.push(e.name),this.category[4]=this.catlist.category4)})})},go_playlist_all(t){this.$refs.popover.hide(),this.$router.push({name:"playlist_all",query:{cat:t}})},Top_playlist(t){window.scrollTo(0,0),this.visible=!this.visible,this.page.currentPage=1,this.page.pre=0,d({cat:t}).then(l=>{this.total=l.total,l.playlists.forEach(a=>{a.coverImgUrl=a.coverImgUrl+"?param=140y140"}),this.page.tableData=l.playlists,this.playlist_hight=this.page.tableData.slice(this.page.pre,this.page.pre+20)});let e=0,i=setInterval(async()=>{await d({cat:this.query_cat,offset:100}).then(l=>{e+=100,l.playlists.forEach(a=>{a.coverImgUrl=a.coverImgUrl+"?param=130y130"}),this.page.tableData=this.page.tableData.concat(l.playlists)}),e>=700&&clearInterval(i)},100)}},watch:{"$route.query.cat"(t,e){if(this.$route.query.cat!=null||this.$route.query.cat!="\u5168\u90E8")this.Top_playlist(this.$route.query.cat);else return}}},V=t=>(j("data-v-0fbd9eb8"),t=t(),B(),t),A={class:"main"},F={class:"songplay_head"},L={style:{"padding-right":"15px"}},M=x("\u9009\u62E9\u5206\u7C7B"),R={style:{display:"flex","flex-direction":"column",width:"40px",padding:"10px 0px 10px 0px"}},G={style:{padding:"10px 0px 10px 20px",width:"705px"}},H=["onClick"],J={class:"hotRecommend_list"},K={class:"list_li"},O=["onClick"],Q={class:"buttom"},W=V(()=>s("img",{style:{width:"20px",height:"20px",padding:"10px"},src:T,alt:""},null,-1)),X={style:{color:"#ccc",font:"20px '\u96B6\u4E66'"}},Y=["onClick"];function Z(t,e,i,l,a,n){const b=h("el-button"),w=h("el-divider"),k=h("el-popover"),C=h("el-pagination"),q=z("lazy");return r(),c("div",A,[s("div",F,[s("span",L,p(a.query_cat),1),g(k,{ref:"popover",placement:"bottom-start",title:"\u5168\u90E8\u5206\u7C7B",width:800,trigger:"click","hide-after":200},{reference:u(()=>[g(b,null,{default:u(()=>[M]),_:1})]),default:u(()=>[(r(!0),c(m,null,v(a.catlist.categories,(o,_)=>(r(),c("div",{style:{display:"flex","flex-direction":"row",padding:"20px:min-width:730px",width:"730px"},key:o},[s("div",R,[s("span",null,p(o),1)]),s("div",G,[(r(!0),c(m,null,v(a.category[_],y=>(r(),c("span",{key:y,onClick:tt=>n.go_playlist_all(y),style:{cursor:"pointer"}},[x(p(y)+" ",1),g(w,{direction:"vertical"})],8,H))),128))])]))),128))]),_:1},512)]),s("div",null,[s("div",J,[(r(!0),c(m,null,v(a.playlist_hight,o=>(r(),c("ul",{key:o.id},[s("li",null,[s("div",K,[E((r(),c("img",{key:o.coverImgUrl,onClick:_=>n.go_playlist(o.id),style:{width:"100%",height:"100%"},alt:""},null,8,O)),[[q,o.coverImgUrl]]),s("div",Q,[W,s("span",X,p(n.filter_playCount(o.playCount)),1),s("img",{onClick:_=>n.click_audioPlay(o.id),class:"icon_play",style:{width:"26px",height:"26px"},src:U,alt:""},null,8,Y)])]),s("span",null,p(o.name),1)])]))),128))]),s("div",null,[g(C,{style:{"text-align":"center"},background:"",layout:"prev, pager, next",onCurrentChange:n.handleCurrentChange,"current-page":a.page.currentPage,total:760,"page-size":a.page.pagesize},null,8,["onCurrentChange","current-page","page-size"])])])])}var it=I(N,[["render",Z],["__scopeId","data-v-0fbd9eb8"]]);export{it as default};
